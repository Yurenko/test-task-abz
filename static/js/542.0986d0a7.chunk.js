"use strict";(self.webpackChunktest_task_abz=self.webpackChunktest_task_abz||[]).push([[542],{9471:function(e,r,t){t.d(r,{l:function(){return n}});var n=function(e){return e.response&&e.response.data?"object"===typeof e.response.data.message?e.response.data.message[0]:e.response.data.message:e.message}},8250:function(e,r,t){var n=t(4569),a=t.n(n),s=t(8329),o=a().create({baseURL:"".concat("https://frontend-test-assignment-api.abz.agency/api/v1/"),headers:{"Content-Type":"application/json"}});o.interceptors.request.use((function(e){var r=s.Z.get("accessToken");return e.headers&&r&&(e.headers.Token="".concat(r)),e})),r.Z=o},4542:function(e,r,t){t.r(r),t.d(r,{default:function(){return q}});var n=t(9202),a=t(2791);var s=t.p+"static/media/success-image.0d3202ba11b04fa7364b0f83ce42aea5.svg",o={wrapper:"form_wrapper__Sua34",error:"form_error__NFKfS",form:"form_form__TMbOh",common:"form_common__UIBxx",helperText:"form_helperText__kYy9O",position:"form_position__7239c",upload:"form_upload__mLb-e"},i=t(184),u=function(){return(0,i.jsxs)("div",{className:o.wrapper,children:[(0,i.jsx)(n.Z,{title:"User successfully registered"}),(0,i.jsx)("img",{src:s,alt:"success image"})]})},c=t(1413),l=t(885),p=t(765),d=t(9641),f=t(6540),m=t(5290),h=t(5987),v=["placeholder","helperText","error","type","style"],x=(0,a.forwardRef)((function(e,r){var t=e.placeholder,n=e.helperText,a=e.error,s=e.type,u=void 0===s?"text":s,l=e.style,p=(0,h.Z)(e,v);return(0,i.jsxs)("div",{className:o.common,style:l,children:[(0,i.jsx)("input",(0,c.Z)({ref:r,type:u,placeholder:t},p)),(0,i.jsx)("label",{className:o.field,children:t}),(0,i.jsx)("div",{className:o.helperText,children:n}),a&&(0,i.jsx)("div",{className:o.error,children:a.message})]})}));x.displayName="Field";var g=x,Z=t(8214),_=t(5861),j=(0,a.forwardRef)((function(e,r){var t=e.placeholder,n=e.error,s=e.type,u=e.accept,c=e.onChange,p=e.setBtnDisabled,d=(0,a.useState)("Upload your photo"),f=(0,l.Z)(d,2),m=f[0],h=f[1],v=function(){var e=(0,_.Z)((0,Z.Z)().mark((function e(r){var t;return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==(t=r.target.files)&&void 0!==t&&t.length&&(c(t[0]),h(t[0].name),p(!1));case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return(0,i.jsx)("div",{className:o.upload,children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{ref:r,type:s,placeholder:t,onChange:v,accept:u}),(0,i.jsx)("span",{children:m}),n&&(0,i.jsx)("div",{className:o.error,children:n.message})]})})})),b=j,w=t(6594),y=t(1933),T=t(8250),N=t(2478),S=function(){return(0,_.Z)((0,Z.Z)().mark((function e(){return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.Z.get((0,N.LP)()));case 1:case"end":return e.stop()}}),e)})))()},k=t(8329),P=t(9471),C=t(1470),L={name:"",email:"",phone:"",position_id:null,photo:{}},U=function(e){var r=e.setAddedNewUser,t=(0,m.cI)({defaultValues:L,mode:"onChange"}),s=t.handleSubmit,u=t.register,h=t.formState.errors,v=t.control,x=function(e){var r=(0,y.useQuery)("positions",(function(){return w.K.getPositions()}),{select:function(e){return e.data.positions}}),t=r.isLoading,n=r.data,a=(0,y.useMutation)("form for register",(function(e){return w.K.register(e.name,e.email,e.phone,e.position_id,e.photo)}),{onError:function(e){alert((0,P.l)(e))}}).mutateAsync,s=function(){var r=(0,_.Z)((0,Z.Z)().mark((function r(t){var n;return(0,Z.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,S();case 3:return n=r.sent,k.Z.set("accessToken",n.data.token),r.next=7,a(t);case 7:e(!0),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),alert((0,P.l)(r.t0));case 13:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(e){return r.apply(this,arguments)}}();return{isLoading:t,positions:n,onSubmit:s}}(r),j=x.isLoading,T=x.positions,N=x.onSubmit,U=(0,a.useState)(!0),q=(0,l.Z)(U,2),A=q[0],E=q[1];return(0,i.jsxs)("div",{className:o.wrapper,children:[(0,i.jsx)(n.Z,{title:"Working with POST request"}),(0,i.jsxs)("form",{onSubmit:s(N),className:o.form,children:[(0,i.jsx)(g,(0,c.Z)((0,c.Z)({},u("name",{required:"Name is required!"})),{},{minLength:2,maxLength:60,placeholder:"Your Name",helperText:"",error:h.name})),(0,i.jsx)(g,(0,c.Z)((0,c.Z)({},u("email",{required:"Email is required!"})),{},{type:"email",placeholder:"Email",helperText:"",error:h.email})),(0,i.jsx)(g,(0,c.Z)((0,c.Z)({},u("phone",{required:"Phone is required!",pattern:/^[\+]{0,1}380([0-9]{9})$/})),{},{type:"tel",placeholder:"Phone",helperText:"+38 (XXX) XXX - XX - XX",error:h.phone})),(0,i.jsxs)("div",{className:o.position,children:[(0,i.jsx)("label",{children:"Select your position"}),j?(0,i.jsx)(C.Z,{}):(0,i.jsx)(m.Qr,{render:function(e){var r=e.field;return(0,i.jsx)(p.Z,(0,c.Z)((0,c.Z)({},r),{},{children:T&&T.map((function(e){return(0,i.jsx)(d.Z,{value:e.id,control:(0,i.jsx)(f.Z,{className:o.btn}),label:e.name},e.id)}))}))},name:"position_id",control:v,rules:{required:"Position is required!"}})]}),(0,i.jsx)(m.Qr,{name:"photo",control:v,render:function(e){var r=e.field,t=r.value,n=r.onChange,a=e.fieldState.error;return(0,i.jsx)(b,(0,c.Z)((0,c.Z)({},u("photo")),{},{type:"file",placeholder:"Photo",error:a,accept:"image/jpg, image/jpeg",image:t,onChange:n,setBtnDisabled:E}))},rules:{required:"Photo is required!"}}),(0,i.jsx)("button",{disabled:A,children:"Sign up"})]})]})},q=function(e){var r=e.setAddedNewUser;return e.addedNewUser?(0,i.jsx)(u,{}):(0,i.jsx)(U,{setAddedNewUser:r})}},9202:function(e,r,t){t.d(r,{Z:function(){return s}});var n="MainTitle_title__rBnXv",a=t(184),s=function(e){var r=e.title;return(0,a.jsx)("h1",{className:n,children:r})}},2478:function(e,r,t){t.d(r,{Il:function(){return a},LP:function(){return o},_A:function(){return n},l$:function(){return s}});"".concat({NODE_ENV:"production",PUBLIC_URL:"/test-task-abz",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_URL:"https://frontend-test-assignment-api.abz.agency/api/v1/"}.APP_URL,"/api");var n=function(){return"/users"},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"/users?page=".concat(e,"&count=6")},s=function(){return"/positions"},o=function(){return"/token"}},6594:function(e,r,t){t.d(r,{K:function(){return i}});var n=t(8214),a=t(5861),s=t(2478),o=t(8250),i={register:function(e,r,t,i,u){return(0,a.Z)((0,n.Z)().mark((function a(){var c;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.Z.post((0,s._A)(),{name:e,email:r,phone:t,position_id:i,photo:u},{headers:{"Content-Type":"multipart/form-data"}});case 2:return c=n.sent,n.abrupt("return",c);case 4:case"end":return n.stop()}}),a)})))()},getPositions:function(){return(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.Z.get((0,s.l$)()));case 1:case"end":return e.stop()}}),e)})))()},getUsers:function(){var e=arguments;return(0,a.Z)((0,n.Z)().mark((function r(){var t;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.length>0&&void 0!==e[0]?e[0]:1,r.abrupt("return",o.Z.get((0,s.Il)(t)));case 2:case"end":return r.stop()}}),r)})))()}}}}]);
//# sourceMappingURL=542.0986d0a7.chunk.js.map